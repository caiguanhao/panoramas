!function($){"use strict";var Tooltip=function(element,options){this.init("tooltip",element,options)};Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut,triggers,trigger,i;this.type=type;this.$element=$(element);this.options=this.getOptions(options);this.enabled=true;triggers=this.options.trigger.split(" ");for(i=triggers.length;i--;){trigger=triggers[i];if(trigger=="click"){this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this))}else if(trigger!="manual"){eventIn=trigger=="hover"?"mouseenter":"focus";eventOut=trigger=="hover"?"mouseleave":"blur";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this));this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(options){options=$.extend({},$.fn[this.type].defaults,this.$element.data(),options);if(options.delay&&typeof options.delay=="number"){options.delay={show:options.delay,hide:options.delay}}return options},enter:function(e){var defaults=$.fn[this.type].defaults,options={},self;this._options&&$.each(this._options,function(key,value){if(defaults[key]!=value)options[key]=value},this);self=$(e.currentTarget)[this.type](options).data(this.type);if(!self.options.delay||!self.options.delay.show)return self.show();clearTimeout(this.timeout);self.hoverState="in";this.timeout=setTimeout(function(){if(self.hoverState=="in")self.show()},self.options.delay.show)},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(this.timeout)clearTimeout(this.timeout);if(!self.options.delay||!self.options.delay.hide)return self.hide();self.hoverState="out";this.timeout=setTimeout(function(){if(self.hoverState=="out")self.hide()},self.options.delay.hide)},show:function(){var $tip,pos,actualWidth,actualHeight,placement,tp,e=$.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(e);if(e.isDefaultPrevented())return;$tip=this.tip();this.setContent();if(this.options.animation){$tip.addClass("fade")}placement=typeof this.options.placement=="function"?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement;$tip.detach().css({top:0,left:0,display:"block"});this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);pos=this.getPosition();actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;switch(placement){case"bottom":tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case"top":tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width};break}this.applyPlacement(tp,placement);this.$element.trigger("shown")}},applyPlacement:function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,actualWidth,actualHeight,delta,replace;$tip.offset(offset).addClass(placement).addClass("in");actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;if(placement=="top"&&actualHeight!=height){offset.top=offset.top+height-actualHeight;replace=true}if(placement=="bottom"||placement=="top"){delta=0;if(offset.left<0){delta=offset.left*-2;offset.left=0;$tip.offset(offset);actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight}this.replaceArrow(delta-width+actualWidth,actualWidth,"left")}else{this.replaceArrow(actualHeight-height,actualHeight,"top")}if(replace)$tip.offset(offset)},replaceArrow:function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},setContent:function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title);$tip.removeClass("fade in top bottom left right")},hide:function(){var that=this,$tip=this.tip(),e=$.Event("hide");this.$element.trigger(e);if(e.isDefaultPrevented())return;$tip.removeClass("in");function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).detach()},500);$tip.one($.support.transition.end,function(){clearTimeout(timeout);$tip.detach()})}$.support.transition&&this.$tip.hasClass("fade")?removeWithAnimation():$tip.detach();this.$element.trigger("hidden");return this},fixTitle:function(){var $e=this.$element;if($e.attr("title")||typeof $e.attr("data-original-title")!="string"){$e.attr("data-original-title",$e.attr("title")||"").attr("title","")}},hasContent:function(){return this.getTitle()},getPosition:function(){var el=this.$element[0];return $.extend({},typeof el.getBoundingClientRect=="function"?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())},getTitle:function(){var title,$e=this.$element,o=this.options;title=$e.attr("data-original-title")||(typeof o.title=="function"?o.title.call($e[0]):o.title);return title},tip:function(){return this.$tip=this.$tip||$(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var self=e?$(e.currentTarget)[this.type](this._options).data(this.type):this;self.tip().hasClass("in")?self.hide():self.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("tooltip"),options=typeof option=="object"&&option;if(!data)$this.data("tooltip",data=new Tooltip(this,options));if(typeof option=="string")data[option]()})};$.fn.tooltip.Constructor=Tooltip;$.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:false,container:false};$.fn.tooltip.noConflict=function(){$.fn.tooltip=old;return this}}(window.jQuery);!function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:Popover,setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title);$tip.find(".popover-content")[this.options.html?"html":"text"](content);$tip.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var content,$e=this.$element,o=this.options;content=(typeof o.content=="function"?o.content.call($e[0]):o.content)||$e.attr("data-content");return content},tip:function(){if(!this.$tip){this.$tip=$(this.options.template)}return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var old=$.fn.popover;$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("popover"),options=typeof option=="object"&&option;if(!data)$this.data("popover",data=new Popover(this,options));if(typeof option=="string")data[option]()})};$.fn.popover.Constructor=Popover;$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'});$.fn.popover.noConflict=function(){$.fn.popover=old;return this}}(window.jQuery);(function($){$.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:true,useTransitionEnd:false};var div=document.createElement("div");var support={};function getVendorPropertyName(prop){if(prop in div.style)return prop;var prefixes=["Moz","Webkit","O","ms"];var prop_=prop.charAt(0).toUpperCase()+prop.substr(1);if(prop in div.style){return prop}for(var i=0;i<prefixes.length;++i){var vendorProp=prefixes[i]+prop_;if(vendorProp in div.style){return vendorProp}}}function checkTransform3dSupport(){div.style[support.transform]="";div.style[support.transform]="rotateY(90deg)";return div.style[support.transform]!==""}var isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;support.transition=getVendorPropertyName("transition");support.transitionDelay=getVendorPropertyName("transitionDelay");support.transform=getVendorPropertyName("transform");support.transformOrigin=getVendorPropertyName("transformOrigin");support.transform3d=checkTransform3dSupport();var eventNames={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"};var transitionEnd=support.transitionEnd=eventNames[support.transition]||null;for(var key in support){if(support.hasOwnProperty(key)&&typeof $.support[key]==="undefined"){$.support[key]=support[key]}}div=null;$.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"};$.cssHooks["transit:transform"]={get:function(elem){return $(elem).data("transform")||new Transform},set:function(elem,v){var value=v;if(!(value instanceof Transform)){value=new Transform(value)}if(support.transform==="WebkitTransform"&&!isChrome){elem.style[support.transform]=value.toString(true)}else{elem.style[support.transform]=value.toString()}$(elem).data("transform",value)}};$.cssHooks.transform={set:$.cssHooks["transit:transform"].set};if($.fn.jquery<"1.8"){$.cssHooks.transformOrigin={get:function(elem){return elem.style[support.transformOrigin]},set:function(elem,value){elem.style[support.transformOrigin]=value}};$.cssHooks.transition={get:function(elem){return elem.style[support.transition]},set:function(elem,value){elem.style[support.transition]=value}}}registerCssHook("scale");registerCssHook("translate");registerCssHook("translate3d");registerCssHook("rotate");registerCssHook("rotateX");registerCssHook("rotateY");registerCssHook("rotate3d");registerCssHook("perspective");registerCssHook("skewX");registerCssHook("skewY");registerCssHook("x",true);registerCssHook("y",true);registerCssHook("z",true);function Transform(str){if(typeof str==="string"){this.parse(str)}return this}Transform.prototype={setFromString:function(prop,val){var args=typeof val==="string"?val.split(","):val.constructor===Array?val:[val];args.unshift(prop);Transform.prototype.set.apply(this,args)},set:function(prop){var args=Array.prototype.slice.apply(arguments,[1]);if(this.setter[prop]){this.setter[prop].apply(this,args)}else{this[prop]=args.join(",")}},get:function(prop){if(this.getter[prop]){return this.getter[prop].apply(this)}else{return this[prop]||0}},setter:{rotate:function(theta){this.rotate=unit(theta,"deg")},rotateX:function(theta){this.rotateX=unit(theta,"deg")},rotateY:function(theta){this.rotateY=unit(theta,"deg")},scale:function(x,y){if(y===undefined){y=x}this.scale=x+","+y},skewX:function(x){this.skewX=unit(x,"deg")},skewY:function(y){this.skewY=unit(y,"deg")},perspective:function(dist){this.perspective=unit(dist,"px")},x:function(x){this.set("translate",x,null,null)},y:function(y){this.set("translate",null,y,null)},z:function(z){this.set("translate3d",null,null,z)},translate:function(x,y){this.set("translate3d",x,y,0)},translate3d:function(x,y,z){if(this._translateX===undefined){this._translateX=0}if(this._translateY===undefined){this._translateY=0}if(this._translateZ===undefined){this._translateZ=0}if(x!==null&&x!==undefined){this._translateX=unit(x,"px")}if(y!==null&&y!==undefined){this._translateY=unit(y,"px")}if(z!==null&&z!==undefined){this._translateZ=unit(z,"px")}this.translate3d=this._translateX+","+this._translateY+","+this._translateZ}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},z:function(){return this._translateZ||0},scale:function(){var s=(this.scale||"1,1").split(",");if(s[0]){s[0]=parseFloat(s[0])}if(s[1]){s[1]=parseFloat(s[1])}return s[0]===s[1]?s[0]:s},rotate3d:function(){var s=(this.rotate3d||"0,0,0,0deg").split(",");for(var i=0;i<=3;++i){if(s[i]){s[i]=parseFloat(s[i])}}if(s[3]){s[3]=unit(s[3],"deg")}return s}},parse:function(str){var self=this;str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(x,prop,val){self.setFromString(prop,val)})},toString:function(use3d){var re=[];for(var i in this){if(this.hasOwnProperty(i)){if(!support.transform3d&&(i==="rotateX"||i==="rotateY"||i==="perspective"||i==="transformOrigin")){continue}if(i[0]!=="_"){if(use3d&&i==="scale"){re.push(i+"3d("+this[i]+",1)")}else if(use3d&&i==="translate"){re.push(i+"3d("+this[i]+",0)")}else{re.push(i+"("+this[i]+")")}}}}return re.join(" ")}};function callOrQueue(self,queue,fn){if(queue===true){self.queue(fn)}else if(queue){self.queue(queue,fn)}else{fn()}}function getProperties(props){var re=[];$.each(props,function(key){key=$.camelCase(key);key=$.transit.propertyMap[key]||$.cssProps[key]||key;key=uncamel(key);if($.inArray(key,re)===-1){re.push(key)}});return re}function getTransition(properties,duration,easing,delay){var props=getProperties(properties);if($.cssEase[easing]){easing=$.cssEase[easing]}var attribs=""+toMS(duration)+" "+easing;if(parseInt(delay,10)>0){attribs+=" "+toMS(delay)}var transitions=[];$.each(props,function(i,name){transitions.push(name+" "+attribs)});return transitions.join(", ")}$.fn.transition=$.fn.transit=function(properties,duration,easing,callback){var self=this;var delay=0;var queue=true;if(typeof duration==="function"){callback=duration;duration=undefined}if(typeof easing==="function"){callback=easing;easing=undefined}if(typeof properties.easing!=="undefined"){easing=properties.easing;delete properties.easing}if(typeof properties.duration!=="undefined"){duration=properties.duration;delete properties.duration}if(typeof properties.complete!=="undefined"){callback=properties.complete;delete properties.complete}if(typeof properties.queue!=="undefined"){queue=properties.queue;delete properties.queue}if(typeof properties.delay!=="undefined"){delay=properties.delay;delete properties.delay}if(typeof duration==="undefined"){duration=$.fx.speeds._default}if(typeof easing==="undefined"){easing=$.cssEase._default}duration=toMS(duration);var transitionValue=getTransition(properties,duration,easing,delay);var work=$.transit.enabled&&support.transition;var i=work?parseInt(duration,10)+parseInt(delay,10):0;if(i===0){var fn=function(next){self.css(properties);if(callback){callback.apply(self)}if(next){next()}};callOrQueue(self,queue,fn);return self}var oldTransitions={};var run=function(nextCall){var bound=false;var cb=function(){if(bound){self.unbind(transitionEnd,cb)}if(i>0){self.each(function(){this.style[support.transition]=oldTransitions[this]||null})}if(typeof callback==="function"){callback.apply(self)}if(typeof nextCall==="function"){nextCall()}};if(i>0&&transitionEnd&&$.transit.useTransitionEnd){bound=true;self.bind(transitionEnd,cb)}else{window.setTimeout(cb,i)}self.each(function(){if(i>0){this.style[support.transition]=transitionValue}$(this).css(properties)})};var deferredRun=function(next){this.offsetWidth;run(next)};callOrQueue(self,queue,deferredRun);return this};function registerCssHook(prop,isPixels){if(!isPixels){$.cssNumber[prop]=true}$.transit.propertyMap[prop]=support.transform;$.cssHooks[prop]={get:function(elem){var t=$(elem).css("transit:transform");return t.get(prop)},set:function(elem,value){var t=$(elem).css("transit:transform");t.setFromString(prop,value);$(elem).css({"transit:transform":t})}}}function uncamel(str){return str.replace(/([A-Z])/g,function(letter){return"-"+letter.toLowerCase()})}function unit(i,units){if(typeof i==="string"&&!i.match(/^[\-0-9\.]+$/)){return i}else{return""+i+units}}function toMS(duration){var i=duration;if($.fx.speeds[i]){i=$.fx.speeds[i]}return unit(i,"ms")}$.transit.getTransitionValue=getTransition})(jQuery);(function($){$.fn.leanorama=function(options){var leanorama={$el:this,$scope:this.parent(),EV_INIT:"leanoramaInit",EV_RESIZE:"leanoramaResize",EV_RESIZED:"leanoramaResized",EV_ENGINE_STARTED:"leanoramaEngineStarted",EV_ENGINE_STARTING:"leanoramaEngineStarting",EV_ENGINE_STOPPED:"leanoramaEngineStopped",EV_ENGINE_STOPPING:"leanoramaEngineStopping",EV_VIEW_CHANGED:"leanoramaViewChanged",EV_VIEW_TRANSITION_STARTED:"leanoramaViewTransitionStarted",EV_VIEW_TRANSITION_STOPPED:"leanoramaViewTransitionStopped",EV_AUTOROTATE_STARTED:"leanoramaAutorotateStarted",EV_AUTOROTATE_STOPPED:"leanoramaAutorotateStopped",EV_REFRESH:"leanoramaRefresh",CON_VIEWPORT_WIDTH_LIMIT:500,CON_VIEWPORT_HEIGHT_LIMIT:500,limit:{top:85,bottom:-85,right:999,left:-999},lon:0,lat:0,scale:1,autorotate:0,gyrostab:0,fading:true,autostart:true,mouse:true,kbd:true,gyro:true,touch:false,delay:25,perspective:645,dlan:0,dlon:0,dscale:0,transitions:0};$.extend(leanorama,options);(function(){var SIDES=["front","left","back","right","top","bottom"],started=false,$el=this.$el,delay=25,interval,prev_lon,prev_lat,prev_scale,dlon,dlat;this.scale_start=function(dscale){this.transitions++;$el.trigger(this.EV_VIEW_TRANSITION_STARTED);this.dscale=dscale};this.scale_stop=function(){this.dscale=0;$el.trigger(this.EV_VIEW_TRANSITION_STOPPED)};this.scale_by=function(dscale){this.scale+=dscale};this.pan_start=function(dlon,dlat){$el.trigger(this.EV_VIEW_TRANSITION_STARTED);this.dlon=dlon||this.dlon||0;this.dlat=dlat||this.dlat||0};this.pan_stop=function(dir){this.dlon=!dir||dir=="lon"?0:this.dlon;this.dlat=!dir||dir=="lat"?0:this.dlat;$el.trigger(this.EV_VIEW_TRANSITION_STOPPED)};this.pan_by=function(dlon,dlat){this.lon+=dlon;this.lat+=dlat};this.restart=function(){if(started){$el.bind(this.EV_ENGINE_STOPPED+".restart",$.proxy(function(){$el.unbind(this.EV_ENGINE_STOPPED+".restart");this.start()},this));this.stop()}else{this.start()}};this.refresh=function(e,data){$.extend(this,data);this.restart()};this.stop=function(){if(!started)return;var defunct=this.$container;var do_stop=function(){window.clearInterval(interval);defunct.remove();started=false;this.$el.trigger(this.EV_ENGINE_STOPPED)};if(this.fading){defunct.animate({opacity:0},2e3,do_stop.call(this))}else{do_stop.call(this)}};this.start=function(){if(started)return this.restart();this.$sides=[];for(i in SIDES)this.$sides[i]=div({"class":"leanorama-side leanorama-side-"+SIDES[i],style:'background-image : url("'+this.sides[i]+'");'});this.$cube=div({"class":"leanorama-cube"}).append(this.$sides);this.$surface=div({"class":"leanorama-surface"}).append(this.$cube);this.$container=$(document.createElement("section")).addClass("leanorama-container").append(this.$surface);$el.html(this.$container);this.fading&&this.$container.css("opacity",0);$el.addClass("leanorama-target");this.$surface.css({top:(this.$container.height()-this.$surface.height())/2+"px",left:(this.$container.width()-this.$surface.width())/2+"px"});this.$cube.css({top:this.$cube.height()/-4+"px",left:this.$cube.width()/-4+"px"});this.lat=0;this.animate();this.fading&&this.$container.animate({opacity:1},2e3);started=true;this.$el.trigger(this.EV_ENGINE_STARTED)};this.animate=function(){window.clearInterval(interval);interval=window.setInterval($.proxy(function(){if(this.dlon||this.dlat){this.autorotate&&this.toggle_rotate();this.lon+=this.dlon;this.lat+=this.dlat}this.scale+=this.dscale;this.lon+=this.autorotate;if(this.lat>this.limit.top||this.lat<this.limit.bottom)this.lat=prev_lat;if(this.lon>=this.limit.right&&this.lon>prev_lon&&prev_lon<=this.limit.right||this.lon<=this.limit.left&&this.lon<prev_lon&&prev_lon>=this.limit.left){this.lon=prev_lon;this.autorotate=-this.autorotate}if(this.scale<1)this.scale=1;if(this.scale>8)this.scale=8;this.lon=degnormalize(this.lon);this.update_view();if(!(prev_lon==this.lon&&prev_lat==this.lat&&prev_scale==this.scale)){dlon=this.lon-prev_lon;dlat=this.lat-prev_lat;prev_lon=this.lon;prev_lat=this.lat;prev_scale=this.scale;$el.trigger(this.EV_VIEW_CHANGED)}},this),this.delay)};this.update_view=function(){this.$container.transition({scale:this.scale},0);this.$surface.transition({z:this.perspective,rotateX:this.lat,rotateY:this.lon},0)};this.toggle_rotate=function(){if(this.autorotate){this.autorotate=0;$el.trigger(this.EV_AUTOROTATE_STOPPED)}else{this.autorotate=.1;$el.trigger(this.EV_AUTOROTATE_STARTED)}};this.viewport=function(){var viewPortWidth;var viewPortHeight;if(typeof window.innerWidth!="undefined"){viewPortWidth=window.innerWidth,viewPortHeight=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){viewPortWidth=document.documentElement.clientWidth,viewPortHeight=document.documentElement.clientHeight}else{viewPortWidth=document.getElementsByTagName("body")[0].clientWidth,viewPortHeight=document.getElementsByTagName("body")[0].clientHeight}return{width:viewPortWidth,height:viewPortHeight}};for(e in $.fn.leanorama.extensions){$.fn.leanorama.extensions[e].call(this)}this.autostart&&this.start();$el.trigger(this.EV_INIT);$el.on(this.EV_REFRESH,$.proxy(this.refresh,this))}).call(leanorama);return this};var ext_ctrl=function(){var $el=this.$el;$.extend(this,{EV_CONTROLS_BIND_ALL:"leanoramaControlsBindAll",EV_CONTROLS_UNBIND_ALL:"leanoramaControlsUnbindAll"});this.bind_functions=[];this.unbind_functions=[];this.bind_all=function(){for(f in this.bind_functions){this[f]&&this.bind_functions[f].call(this)}};this.unbind_all=function(){for(f in this.unbind_functions){this[f]&&this.unbind_functions[f].call(this)}};$el.bind(this.EV_ENGINE_STARTED,$.proxy(this.bind_all,this));$el.bind(this.EV_ENGINE_STOPPED,$.proxy(this.unbind_all,this))};var ext_ctrl_mouse=function(){var $el=this.$el;$.extend(this,{EV_CONTROLS_MOUSE_ON:"leanoramaControlsMouseOn",EV_CONTROLS_MOUSE_OFF:"leanoramaControlsMouseOff"});function mousewheel(e){e.preventDefault();this.scale*=e.originalEvent.wheelDeltaY>0?1.1:.9;e.stopPropagation()}function mousedown(e){e.preventDefault();var x0,y0;this.$container.bind("mousemove",$.proxy(function(e){x0=x0||e.screenX;y0=y0||e.screenY;this.lon-=(e.screenX-x0)*.1;this.lat+=(e.screenY-y0)*.1;x0=e.screenX;y0=e.screenY},this));this.autorotate&&this.toggle_rotate();e.stopPropagation()}function mouseup(e){e.preventDefault();this.$container.unbind("mousemove");e.stopPropagation()}this.bind_mouse=function(){$el.bind("mousewheel",$.proxy(mousewheel,this));$el.bind("mousedown",$.proxy(mousedown,this));$el.bind("mouseup",$.proxy(mouseup,this));$el.trigger(this.EV_CONTROLS_MOUSE_ON)};this.unbind_mouse=function(){$el.unbind("mousewheel");$el.unbind("mousedown");$el.unbind("mouseup");$el.trigger(this.EV_CONTROLS_MOUSE_OFF)};this.bind_functions.mouse=this.bind_mouse;this.unbind_functions.mouse=this.unbind_mouse};var ext_ctrl_kbd=function(){var $el=this.$el;$.extend(this,{EV_CONTROLS_KEYBOARD_ON:"leanoramaControlsKeyboardOn",EV_CONTROLS_KEYBOARD_OFF:"leanoramaControlsKeyboardOff"});function keydown(e){var which=e.originalEvent.which;if(which==37)this.pan_start(-2,0);else if(which==38)this.pan_start(0,2);else if(which==39)this.pan_start(2,0);else if(which==40)this.pan_start(0,-2);else if(which==187)this.scale_start(.1);else if(which==189)this.scale_start(-.1);else if(which==32)this.toggle_rotate()}function keyup(e){var which=e.originalEvent.which;if(which==38||which==40)this.pan_stop("lat");if(which==37||which==39)this.pan_stop("lon");if(which==187||which==189)this.scale_stop()}this.bind_kbd=function(){$(window).bind("keydown.leanorama",$.proxy(keydown,this));$(window).bind("keyup.leanorama",$.proxy(keyup,this));$el.trigger(this.EV_CONTROLS_KEYBOARD_ON)};this.unbind_kbd=function(){$(window).unbind("keyup.leanorama");$(window).unbind("keydown.leanorama");$el.trigger(this.EV_CONTROLS_KEYBOARD_OFF)};this.bind_functions.kbd=this.bind_kbd;this.unbind_functions.kbd=this.unbind_kbd};var ext_ctrl_touch=function(){var $el=this.$el,t0x0,t0y0,t1x0,t1y0,estack=[];function touchstart(e){$el.trigger(this.EV_VIEW_TRANSITION_STARTED);e.preventDefault();t0x0=e.originalEvent.touches[0].screenX;t0y0=e.originalEvent.touches[0].screenY;if(e.originalEvent.touches[1]){t1x0=e.originalEvent.touches[1].screenX;t1y0=e.originalEvent.touches[1].screenY}e.stopPropagation()}function touchmove(e){e.preventDefault();var t0x=e.originalEvent.touches[0].screenX,t0y=e.originalEvent.touches[0].screenY;if(e.originalEvent.touches[1]){var t1x=e.originalEvent.touches[1].screenX,t1y=e.originalEvent.touches[1].screenY;t1x0=t1x0||e.originalEvent.touches[1].screenX;t1y0=t1y0||e.originalEvent.touches[1].screenY;var dis=Math.sqrt(Math.pow(Math.abs(t1x-t0x),2)+Math.pow(Math.abs(t1y-t0y),2));var dis0=Math.sqrt(Math.pow(Math.abs(t1x0-t0x0),2)+Math.pow(Math.abs(t1y0-t0y0),2));this.scale_by(dis/dis0-1||0);t1x0=t1x;t1y0=t1y}else{dx=t0x-t0x0||0;dy=t0y-t0y0||0;this.pan_by(-dx*.2,dy*.2)}t0x0=t0x;t0y0=t0y;e.stopPropagation();this.autorotate&&this.toggle_rotate();return false}function touchend(e){e.preventDefault();this.pan_stop();t0x0=undefined;t0y0=undefined;t1x0=undefined;t1y0=undefined;return false}this.bind_touch=function(){$el.bind("touchstart.leanorama",$.proxy(touchstart,this));$el.bind("touchmove.leanorama",$.proxy(touchmove,this));$el.bind("touchend.leanorama",$.proxy(touchend,this))};this.unbind_touch=function(){$el.bind("touchstart.leanorama");$el.bind("touchmove.leanorama");$el.bind("touchend.leanorama")};this.bind_functions.touch=this.bind_touch;this.unbind_functions.touch=this.unbind_touch};$.fn.leanorama.extensions=[ext_ctrl,ext_ctrl_mouse,ext_ctrl_kbd,ext_ctrl_touch];if(window.DeviceOrientationEvent){var ext_ctrl_gyro=function(){var $el=this.$el,gyro=true,alpha0=0,gamma0=0,was_gyro=false,alphas=[],gammas=[],moving=false;$.extend(this,{EV_CONTROLS_GYRO_ON:"leanoramaControlsGyroOn",EV_CONTROLS_GYRO_OFF:"leanoramaControlsGyroOff"});function deviceorientation(e){if(this.autorotate)return;if(moving)return;moving=true;e.preventDefault();var ev=e.originalEvent;if(!(ev.alpha||ev.beta||ev.gamma)){this.gyro=false;this.unbind_gyro();return}if(!alpha0){alpha0=alpha0||ev.alpha;gamma0=gamma0||0}var alpha=0,gamma=0;for(i=1;i<alphas.length;i++){if(Math.abs(alphas[alphas.length-1]-ev.alpha)<100)alphas[i-1]=alphas[i]||ev.alpha;else alphas[i-1]=ev.alpha;if(Math.abs(gammas[gammas.length-1]-ev.gamma)<100)gammas[i-1]=gammas[i]||0;else gammas[i-1]=ev.gamma;alpha+=alphas[i-1];gamma+=gammas[i-1]}alphas[alphas.length?alphas.length-1:0]=ev.alpha;gammas[gammas.length?gammas.length-1:0]=ev.gamma;alpha=(alpha+alphas[alphas.length-1])/alphas.length;gamma=(gamma+gammas[gammas.length-1])/gammas.length;if(gamma>=-180&&gamma<=180)this.lat=Math.abs(gamma)-90+gamma0;if(gamma>180||gamma<-180)this.lat=270-Math.abs(gamma)+gamma0;this.lon=degnormalize(alpha0-alpha+90);moving=false}this.bind_gyro=function(){if(this.autorotate)return;this.gyro=true;alpha0=undefined;gamma0=undefined;$(window).bind("deviceorientation.leanorama",$.proxy(deviceorientation,this));$el.trigger(this.EV_CONTROLS_GYRO_ON);$el.bind(this.EV_VIEW_TRANSITION_STARTED,$.proxy(this.suspend_gyro,this))};this.unbind_gyro=function(){if(!this.gyro)return;$(window).unbind("deviceorientation.leanorama");this.gyro=false;$el.trigger(this.EV_CONTROLS_GYRO_OFF);$el.unbind(this.EV_VIEW_TRANSITION_STARTED);$el.unbind(this.EV_VIEW_TRANSITION_STOPPED)};this.suspend_gyro=function(){this.unbind_gyro();$el.bind(this.EV_VIEW_TRANSITION_STOPPED,$.proxy(this.restore_gyro,this))};this.restore_gyro=function(){this.bind_gyro()};this.bind_functions.gyro=this.bind_gyro;this.unbind_functions.gyro=this.unbind_gyro};$.fn.leanorama.extensions.push(ext_ctrl_gyro)}function div(attrs){return $(document.createElement("div")).attr(attrs)}function degnormalize(deg){while(deg>180)deg-=360;while(deg<-180)deg+=360;return deg}})(jQuery);$.fn.leanorama.extensions.push(function(){this.EV_HOTSPOT_CLICK="leanoramaHotspotClick";var $hotspots=[];function create_hotspot(data){var geometry=data.geometry||"dot",type=data.type||"nav",ix=$hotspots.length,$hotspot=div({"class":"leanorama-hotspot leanorama-hotspot-"+geometry,id:data.id}),$handle=div({"class":"leanorama-hotspot-handle"}),$handle_inner=div({"class":"leanorama-hotspot-handle-"+type,id:data.id+"_handle"});var title;switch(type){case"nav":title=data.name||"Go to";$handle_inner.attr("rel","tooltip").attr("data-html",true).attr("data-original-title",title);break;case"info":var closebtn='<span class="btn btn-mini btn-danger" style="float: right;" onclick="$(\'#'+data.id+"_handle').popover('hide');\">x</span>";title="<b>"+(data.name||"Information")+"</b>"+closebtn;var content=data.value||data.name||"N/A";$handle_inner.attr("rel","popover").attr("data-html",true).attr("data-original-title",title).attr("data-content",content);break;case"link":title=data.name||"Link";$handle_inner.attr("rel","tooltip").attr("data-html",true).attr("data-original-title",title).click(function(){window.open(data.value,"_blank")});break;case"action":title=data.name||"Turn On/Off";$handle_inner.attr("rel","tooltip").attr("trigger","manual").attr("data-placement","bottom").attr("data-html",true).attr("data-original-title",title);break}this.$sides[data.face].append($hotspot);$hotspot.css({top:data.y,left:data.x});this.$el.append($handle.append($handle_inner));$(".leanorama-hotspot-handle-info").popover();$(".leanorama-hotspot-handle-nav").tooltip();$(".leanorama-hotspot-handle-link").tooltip();$handle.bind("touchend click",$.proxy(function(){this.$el.trigger(this.EV_HOTSPOT_CLICK,[data])},this));$hotspots[ix]={hotspot:$hotspot,data:data,handle:$handle};this.lon+=.01}this.$el.bind(this.EV_VIEW_CHANGED,$.proxy(function(){for(var ix in $hotspots){var $hotspot=$hotspots[ix].hotspot,$handle=$hotspots[ix].handle,data=$hotspots[ix].data,lon_face=[90,180,-90,0],w=this.$sides[data.face].width()/2,angle=degnormalize(lon_face[data.face]+Math.atan((data.x-w)/w)*180/Math.PI);if(data.face<=3&&inrange(angle-90,angle+90,this.lon)||data.face==4&&this.lat>0||data.face==5&&this.lat<0){var rect=$hotspot[0].getBoundingClientRect(),frect=this.$el[0].getBoundingClientRect(),offset={top:this.$el.offset().top-frect.top+rect.top,left:this.$el.offset().left-frect.left+rect.left};$handle.css("opacity",1);$handle.offset(offset)}else{$handle.css("opacity",0)}}},this));this.$el.bind(this.EV_ENGINE_STOPPED,function(){$(".leanorama-hotspot-handle").animate({opacity:this.fading?0:1},this.fading?2e3:0)});this.$el.bind(this.EV_ENGINE_STARTED,$.proxy(function(){for(i in this.hotspots){create_hotspot.call(this,this.hotspots[i])}},this));function div(attrs){return $(document.createElement("div")).attr(attrs)}function span(attrs){return $(document.createElement("span")).attr(attrs)}function degnormalize(deg){while(deg>180)deg-=360;
while(deg<-180)deg+=360;return deg}function inrange(limitl,limitr,angle){limitr+=limitr>limitl||360;return limitl<angle&&limitr>angle||limitl-360<angle&&limitr-360>angle||limitl+360<angle&&limitr+360>angle}});$.fn.leanorama.extensions.push(function start(){var $bar,$controls;function create_controlbar(){$(".leanorama-controlbar",this.$scope).remove();$controls={show:div({"class":"leanorama-controlbar-button"}).html("v").css("display","none").css("margin-left",".5em"),hide:div({"class":"leanorama-controlbar-button actionable"}).html("h"),delim:div({"class":"leanorama-controlbar-button"}).html("|"),zoomin:div({"class":"leanorama-controlbar-button actionable"}).html("+"),zoomout:div({"class":"leanorama-controlbar-button actionable"}).html("-"),play:div({"class":"leanorama-controlbar-button actionable"}).html("p"),stop:div({"class":"leanorama-controlbar-button actionable"}).html("s"),up:div({"class":"leanorama-controlbar-button actionable"}).html("u"),down:div({"class":"leanorama-controlbar-button actionable"}).html("d"),left:div({"class":"leanorama-controlbar-button actionable"}).html("l"),right:div({"class":"leanorama-controlbar-button actionable"}).html("r"),touch:div({"class":"leanorama-controlbar-button actionable"}).html("t"),gyro:div({"class":"leanorama-controlbar-button actionable"}).html("g")};if(this.autorotate===0){$controls.stop.css("display","none")}else{$controls.play.css("display","none")}var $container=div({"class":"leanorama-controlbar-controls"}).append($controls.hide).append($controls.delim);var canHandleOrientation;if(window.DeviceOrientationEvent){window.addEventListener("deviceorientation",handleOrientation,false)}function handleOrientation(event){canHandleOrientation=event}if(canHandleOrientation){$container.append($controls.touch).append($controls.gyro);if(this.gyro){$controls.gyro.css("display","none")}else{$controls.touch.css("display","none")}}$container.append($controls.zoomin).append($controls.zoomout).append($controls.left).append($controls.right).append($controls.up).append($controls.down).append($controls.play).append($controls.stop).append($controls.show);$bar=div({"class":"leanorama-controlbar"});$bar.append(div({"class":"leanorama-controlbar-bg"}));$bar.append($container);$bar.css("display","none");this.$el.after($bar);$bar.fadeIn("slow");$controls.hide.click($.proxy(function(){this.toggle_controlbar()},this));$controls.show.click($.proxy(function(){this.toggle_controlbar()},this));$controls.play.click($.proxy(function(){show_stop();this.toggle_rotate()},this));$controls.stop.click($.proxy(function(){show_play();this.toggle_rotate()},this));$(window).bind("keydown",$.proxy(function(e){if(e.originalEvent.which==32){this.toggle_rotate();if(this.autorotate===0)$controls.play.click();else $controls.stop.click()}},this));$controls.gyro.click($.proxy(function(){this.unbind_touch();this.bind_gyro();$controls.gyro.hide();$controls.touch.fadeIn("fast")},this));$controls.touch.click($.proxy(function(){this.unbind_gyro();this.bind_touch();$controls.touch.hide();$controls.gyro.fadeIn("fast")},this));$controls.zoomin.bind("touchstart mousedown",$.proxy(function(){this.scale_start(.05)},this)).bind("touchend mouseup",$.proxy(function(){this.scale_stop()},this));$controls.zoomout.bind("touchstart mousedown",$.proxy(function(){this.scale_start(-.05)},this)).bind("touchend mouseup",$.proxy(function(){this.scale_stop()},this));$controls.left.bind("touchstart mousedown",$.proxy(function(){this.pan_start(-.7,0);show_play()},this)).bind("touchend mouseup",$.proxy(function(){this.pan_stop()},this));$controls.right.bind("touchstart mousedown",$.proxy(function(){this.pan_start(.7,0);show_play()},this)).bind("touchend mouseup",$.proxy(function(){this.pan_stop()},this));$controls.up.bind("touchstart mousedown",$.proxy(function(){this.pan_start(0,.7);show_play()},this)).bind("touchend mouseup",$.proxy(function(){this.pan_stop()},this));$controls.down.bind("touchstart mousedown",$.proxy(function(){this.pan_start(0,-.7);show_play()},this)).bind("touchend mouseup",$.proxy(function(){this.pan_stop()},this))}this.toggle_controlbar=$.proxy(function(){if($bar.exists()){$bar.css("left")=="0px"?$controls.show.fadeIn("fast"):$controls.show.fadeOut("fast");$bar.animate({left:$bar.css("left")=="0px"?"-"+($bar.width()-$bar.height()):"0"})}},this);function remove_controlbar(){if($bar.exists()){$bar.fadeOut("slow");setTimeout(function(){$bar.remove()},600)}}function show_play(){$controls.stop.hide();$controls.play.show()}function show_stop(){$controls.play.hide();$controls.stop.show()}this.$el.bind(this.EV_AUTOROTATE_STOPPED,show_play);this.$el.bind(this.EV_AUTOROTATE_STARTED,show_stop);this.$el.bind(this.EV_ENGINE_STARTED,$.proxy(create_controlbar,this));function div(attrs){return $(document.createElement("div")).attr(attrs)}function span(attrs){return $(document.createElement("span")).attr(attrs)}$.fn.exists=function(){return this.length>0}});$.fn.leanorama.extensions.push(function(){this.EV_INFOBOX_STARTED="leanoramaInfoboxStarted";this.create_infobox=function(data){$(".leanorama-infobox",this.$scope).remove();$boxbg=div({"class":"leanorama-infobox-bg"});$boxin=div({"class":"leanorama-infobox-inner"}).append(this.infobox);$box=div({"class":"leanorama-infobox"}).html("").append($boxbg,$boxin);this.$el.after($box);$box.fadeIn("slow");this.$el.trigger(this.EV_INFOBOX_STARTED)};var v=this.viewport();if(v.width>this.CON_VIEWPORT_WIDTH_LIMIT){this.$el.bind(this.EV_ENGINE_STARTED,$.proxy(this.create_infobox,this))}function div(attrs){return $(document.createElement("div")).attr(attrs)}function span(attrs){return $(document.createElement("span")).attr(attrs)}});function parse_panorama(default_scene,scenes){$("#pano").leanorama(scenes[default_scene]).on("leanoramaHotspotClick",function(e,hotspot){if(hotspot.type=="nav")$(this).trigger("leanoramaRefresh",scenes[hotspot.value])})}